#!/bin/bash
# =========================================================================== #
#                                                                             #
#                 ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓                 #
#                 ┃   ███╗   ██╗ ██████╗ ██╗   ██╗ █████╗   ┃                 #
#                 ┃   ████╗  ██║██╔═████╗██║   ██║██╔══██╗  ┃                 #
#                 ┃   ██╔██╗ ██║██║██╔██║██║   ██║███████║  ┃                 #
#                 ┃   ██║╚██╗██║████╔╝██║╚██╗ ██╔╝██╔══██║  ┃                 #
#                 ┃   ██║ ╚████║╚██████╔╝ ╚████╔╝ ██║  ██║  ┃                 #
#                 ┃   ╚═╝  ╚═══╝ ╚═════╝   ╚═══╝  ╚═╝  ╚═╝  ┃                 #
#                 ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛                 #
#                                                                             #
#                        This machine kills fascists.                         #
#                                                                             #
# =========================================================================== #
. $NOVIX_WORKSPACE/lib/_common
function help() {
    echo ""
    echo "===================================================================="
    echo " Used for installing the 'novix' config to this local host."
    echo ""
    echo " WARNING: This will write over all local config!"
    echo " WARNING: This will reset all local changes to your .bashrc"
    echo ""
    echo " [Usage]:  novix-install-local <hostname>"
    echo ""
    echo "===================================================================="
    echo ""
    exit
}

# Usage and help
if [ -z "$1" ]; then help; fi
if [ "$1" = "help" ]; then help; fi
if [ "$1" = "--help" ]; then help; fi
if [ "$1" = "-h" ]; then help; fi
if [ "$UID" != "0" ]; then echo '**Must be ran as root user with privileges!**'; exit; fi

HOSTNAME=$1

# Configure the hostname for the remote "etc" directory
echo $HOSTNAME > $NOVIX_WORKSPACE/etc/hostname

# Send the configuration to the remote
$NOVIX_WORKSPACE/bin/novix-configure-local

echo "Begin local install"
hostname $(cat /etc/hostname)
hostnamectl hostname $(cat /etc/hostname)

# Note: Here we install as the local user, so we do NOT run the "novix" script
# Note: We only install the "novix-packages" script
#/home/novix/bin/novix-packages
